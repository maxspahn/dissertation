\chapter{Conclusion and discussion}
\label{cha:conclusion}

\begin{abstract}
The final chapter of this thesis summarizes the
contributions and discusses the main results. Besides,
research questions for the following years are raised, and
potential approaches are laid out. This chapter ends with
a vision on the future of robotics in human-shared
environments.
\end{abstract}

\newpage

\section{Conclusion}
\label{sec:conclusion}

% Reference back to introduction
This thesis was stated in the context of labor shortage in the global North and
the need for further automation to combat demographic change. In particular, we
focused on the problem of \ac{tg} for mobile manipulators in human-shared
environments. This thesis proposed several \ac{tg} methods to allow the safe
deployment of mobile manipulators outside their classical cages.
% Summary of the contributions
This thesis mainly contributed to geometric interpretation of \ac{tg} for
manipulators and mobile manipulators. Specifically, we extended the framework of
\ac{fabrics} to more dynamic environments, proposed a symbolic implementation to
allow for fast parameter tuning at runtime, and demonstrated its effectiveness
in a real demonstration case. Along the way, we showed how \ac{mpc} can be used
for mobile manipulators and why geometric approaches tend to outperform
optimization-based methods for these systems. All results were validated
extensively in simulation and verified in real-world experiments. In the
following, we summarize the main contributions of this thesis.

\subsection{MPC for mobile manipulators}
\label{sec:conclusion_mpc}

\cref{cha:icra_21} extended the widely used method of \ac{fsd} to mobile
manipulators which led to several improvements. First, it allowed to control
the system in a coupled way reducing overall execution time, similar to what had
been done in \cite{Avanzini2018} with dynamic weighing. Second, it reduced the
required accuracy of the perception pipeline as raw point clouds or occupancy
grids can be used. Third, we showed that computationally scaling in the number
of obstacles can be prevented. In \cref{cha:tro_23},
we additionally showed that geometric approaches tend to outperform \ac{mpc}
formulations despite weaker theoretical guarantees.

\subsection{Dynamic fabrics}
\label{sec:conclusion_dynamic_fabrics}

\cref{cha:tro_23} generalized the framework of \ac{fabrics} to dynamic
environments. We showed that \ac{fabrics} can be formulated on moving reference
frames, in such a way that trajectory following and collision avoidance with
dynamic obstacles can be combined with other, static components to the \ac{tg}
problem. Specifically, the \textit{dynamic pull-back}
operator brings a dynamically defined component into the static manifold of the
configuration space while making the motion of the frame a runtime variable of
the root geometry. This chapter showed that reference velocity integration is
required to handle moving obstacles. Additionally, integration of global path
planning in arbitrary manifolds is possible to the generalization. In
particular, this chapter proved that convergence to reference paths can be 
guaranteed. Finally, this chapter presented results on path following with a
mobile manipulator and collision avoidance with moving humans in the workspace.
\MS{What about the extension to non-holonomic systems?}


\subsection{Symbolic fabrics}
\label{sec:conclusion_symbolic_fabrics}

\cref{cha:icra_23} highlighted the existence of a
closed-form solution to \ac{tg} when formulated as a geometric problem.
This property is exploited in a purely symbolic implementation of \ac{fabrics}
which allows for fast parameter tuning. This chapter additionally
proposed to use a Bayesian optimization to tune parameters to \ac{fabrics}.
The experiments showed that expert-level can be reached within 50 iterations.
Additionally, the results revealed that parameter sets can be transferred between
similar embodiment. Finally, qualitative results on a real robot are presented
confirming the applicability to both manipulation and mobile
manipulation.

\subsection{Implicit environment representations}
\label{sec:conclusion_implicit}

\MS{Depending on whether this chapter gets included.}

\subsection{Real-world demonstration}
\label{sec:conclusion_real_world}

\cref{cha:rss_24} demonstrated that \ac{fabrics} are not a mere theoretical
framework but can be used in real-world manipulation demos. In the combination
with a modern decision-making framework, and state-of-the-art perception, 
we demonstrated how \ac{fabrics} can be used to generate trajectories in complex
environments with high-dimensional robots. Besides, it was shown that different
paradigms from \ac{tg} in manipulation, such as learning-based methods and
redundancy resolution, can be easily integrated into the framework.

\section{Discussion}
\label{sec:discussion}

This thesis focused on different methods for \ac{tg} that
are capable to generate motion for mobile manipulators in
human-shared environments. That included the adaption to the
widely used methods of \ac{mpc} to mobile manipulation. The
main part of this thesis was dedicated to a geometric
interpretation of \ac{tg}. Although several advancements for
deploying mobile manipulators safely to human-shared
environments were made, we acknowledge that seeing robots in
our daily lives will still be a rare sight for the years to
come. In the following, we discuss the limitations of the
proposed methods and highlight important missing pieces to
unlock the full potential of mobile manipulators in
human-shared environments.

\subsection{Fabrics or MPC?}
\label{sec:discussion_fabrics_or_mpc}

Most readers are likely familiar with \acl{mpc}, fewer may have seen its application
to, for example, autonomous driving or mobile manipulation, and some 
experienced robotoscists may be aware of the strengths and weaknesses of
\ac{mpc}. In contrast, few readers have heard of \acf{fabrics} before and are 
quick to make a connection between both methods due to the word
\textit{optimization}. However, the methods are
fundamentally different,
and it is important to analyze the differences and similarities between
these methods in an understandable way.
% MPC
\ac{mpc} is centered around the
formulation of a constrained optimization problem. The constraints are
the dynamics of the system and avoidance behaviors, such as collision avoidance
or joint limit avoidance. The problem is solved up to a defined optimality 
criteria. In general, the optimization problem is non-linear and non-convex.
% fabrics
In contrast, \ac{fabrics} is a purely geometric method. It is based on the
formulation of a smooth manifold in the configuration space of the robot.
Then, the solution to the \ac{tg} problem is solution to the geodesic equation
where the manifolds metric is non-Riemannian in general. Importantly, the entire
problem is encoded in the metric by iteratively adding avoidance
behaviors, such as collision avoidance or joint limit avoidance. As the
trajectory is consequence of solving the geodesic equation in each time step, a
closed-form solution is available for explicit behaviors as discussed in this
thesis.
% transition
This fundamentally different view on \ac{tg} has severe implications on
practical implementations.

\paragraph{Reactivity}
\label{par:discussion_reactivity}

One important aspect of \ac{tg} in human-shared environments is the ability to
react fast to changing environments. The \textit{speed} of reaction
of different approaches is captured in what we call \textit{reactivity}.

Due to the closed-form solution, computing actions can be
achieved in roughly 1ms for \ac{fabrics} on a 7-DoF
manipulator. Therefore, \ac{fabrics} can arguably be
considered a controller, that captures geometric environment
aspects. In contrast, the solution to the optimization
problem in \ac{mpc} is generally not available in
closed-form. Therefore, the optimization problem has to be 
solved in each time step. Additionally, the problem is
usually non-convex making the solution costly. In numbers,
when encoding the same \ac{tg} problem in an \ac{mpc}
formulation as in \ac{fabrics}, solver times between 10ms
and 100ms are realistic. That substantially reduces
reactivity of the system making it less suitable for fast
changing environments.

\paragraph{Global optimality}
\label{par:discussion_global_optimiality}

While reactivity is an important aspect to collision
avoidance in dynamic environments, convergence to the goal
state is equally important when it comes to task success of
manipulation tasks. In \ac{mpc} formulations, future states
are considered when constructing the optimization problem,
thus the evolution and, importantly, goal approaching is
optimized over the entire horizon. In the extreme, an
infinitely long horizon would lead to a globally optimal
solution. This is practically impossible to achieve, such
that the horizon is usually limited to a few stages, and the
remaining stages are approximated by a terminal cost.
Nevertheless, \ac{mpc} formulations practically show strong 
behavior in terms avoidance of local minima. In contrast,
\ac{fabrics} is a purely local method, with no consideration
of future states. It relies purely on the shape of the
manifold to guide the motion. This shape however is not
guaranteed to be free of local minima. In fact, we argued in 
\cref{cha:tro_23} that local minima are likely to occur in
cluttered environments. This is a severe limitation which
must be addressed by either global guidance as we suggested,
or by further analyzes of the generated manifolds.

\paragraph{Motion design}
\label{par:motion_design}

We call \textit{motion design} the process of encoding
behaviors into the \ac{tg} problem. Practically, what is the
process for a user to encode different desired behaviors
into the \ac{tg} problem, such that the robot behaves as
indented by the application. In \ac{mpc} formulations,
the behavior is mainly influenced by the objective function
and its weighing factors if multiple objectives are present.
This scalar encoding often proofs to be difficult, because
individual objectives are highly coupled. In contrast,
\ac{fabrics} allow of \textit{iterative} motion design.
Specifically, the defining manifold can be iteratively
enhanced, such that individual components can be tested and
tuned separately. For example, in the experiments of this
thesis, we usually defined behaviors in order of
increasing importance, starting with joint limit avoidance
and ending with goal-reaching. That makes the method
user-friendly and individual components exchangeable if an
application might require that. Moreover, individual
behaviors can be quite complex, such as collision avoidance
defined by signed distance fields, or goal reaching using
deep neural networks, as demonstrated in \cite{xie2023neural}.

In summary, \ac{fabrics} and \ac{mpc} are two fundamentally
different approaches to \ac{tg}. \Ac{mpc} is usually used as
an approximation of the infinite time-horizon optimal
control problem. Using the terminal cost appropriately,
\ac{mpc} formulations lead to reactive behaviors that are
able to avoid local minima up to a certain extent. In
contrast, \ac{fabrics} excels in reactivity and motion
design and should often be regarded as an informed
controller. That comes at the cost of global properties
which must be taken into account when using the method in
cluttered environment. In this thesis, we showed how global
guidance can be integrated using either conventional
path planning or learning-from-demonstration methods.

\subsection{The future of \ac{fabrics}}
\label{sec:discussion_limitations_of_fabrics}

After having discussed differences and similarities between
\ac{mpc} and \ac{fabrics}, we name the core limitations of
our proposed methods and point the reader to potential
future directions of research. 
% continuous time
A practical limitation of \ac{fabrics} --as for any other
geometric method defined in the continuous time domain --
is that the method is not directly applicable to real-world
systems. Specifically, the method has to be discretized and
approximated leading to inaccuracies when tracking continuous
trajectories. A thorough analysis of the discretization
when applied to real robots is missing to this point.
% tuning
Despite improved design-invariant properties on stability
and convergence compared to \ac{rmp}, the tuning of \ac{fabrics} requires some
intuition that usually comes from experience. We aimed to
tackle that problem in \cref{cha:icra_23}, but further
research should be conducted to simplify the tuning process.
Moreover, all behaviors used in this thesis are
hand-crafted, in \cref{cha:icra_23} up to certain
parameters. Hand-crafting \ac{tg} methods is time-consuming
and does not seem to be the right approach in the long run.
Especially considering the success of learning-based methods
in other fields. Therefore, we argue that \ac{fabrics}
should be seen as a compact, yet rich, encoding of
\ac{tg} that serves only as the building structure for
nuanced, learned behaviors. Be ensuring that deep neural
networks exhibit the properties required by the theory of 
\ac{fabrics}, arbitrarily complex behaviors can be
constructed and importantly combined into a single policy.
This approach has been experienced with in \cite{xie2023neural}
and in \cref{cha:rss_24} of this thesis.
% Geometric algebra
When putting a method into the context of geometric
interpretation, it is natural to ask whether other
mathematical concepts can be applied to the problem.
Recently, the field of geometric algebra has gained 
attention in the robotics community, because it allows
to express different geometric shapes and operations in a
single structure, see \cite{low2023geometric} for example.
While low-order geometric algebras can unify translation and
rotation, higher order geometric algebras can be used to unify
different attractors, as they are required by \ac{fabrics}.
For example, attractors in this thesis are limited to
sets of translations, e.g. an end-effector pose can be
encoded as three translational attractors. Higher order
algebra allow encoding attraction to a circle, line, pose
or sphere as an object of the same algebra \cite{low2023geometric}.
From a conceptional point of view, this seems the more
compact understanding of attractors, and from a practical
point of view, it reduces the amount of parameters required.
Future research in \ac{fabrics} should therefore consider
the integration of higher order geometric algebras.
% Online sampling or MPPI
As the goal of mobile manipulators is the interaction with
their environment is the ultimate goal. \Ac{fabrics} do not
take into account contacts with the environment. As a
consquence additional steps must be integrated to really
plan for the interaction, such as grasping.





\subsection{Considerations and vision}
\label{sec:discussion_vision}

After having discussed the advantages and limitations of
methods related to the chapters of this thesis, we also want
to give a broader perspective on robotics. In particular, we
want to shed light on some the reasons why robots have not
entered human shared environments in a more widespread
manner. To make this section a bit more lively, we shall ask
important questions, that are often asked by the public, and
try to answer them in a more philosophical way.


\textit{Why moves the robot so slow?} This is the question that every robotoscist
-- especially those working on \ac{tg} --
has to endure when showing their work to the public. While most, including the
author, are quick to point out that the robot moves slow to ensure safety, the
true reason is more complex. Execution speed is dependent on
(a) the ability to move fast,
(b) the ability to execute trajectories accurately when moving fast,
(c) the ability to make state estimates fast,
(d) the ability to compute trajectories fast,
(e) the effect of speed of motion on the environment,
and, of course,  (f) safety considerations.
Let us treat each of these
points in turn. 
% enumeration in alphabetical order (a) - (f)
\begin{enumerate}[(a)]
  \item When a robot's motors are not powerful enough to
    move fast, the robot will move slow. This is obvious and
    should not be used as an excuse, because all robots used
    in this thesis are capable of moving much faster than
    shown in the experiments. 
  \item Moving fast however is not sufficient as accuracy
    is quite important in manipulation tasks. It turns out
    that modern hardware is quite capable of speeding up
    moving between waypoints defined in the configuration
    space. After all,
    robots in cages are moving extremely fast with
    super-human accuracy so this cannot be the reason for
    slow motion either.
  \item When deployed in human-shared environments however,
    robots cannot simply play back sequences of waypoints in
    an open-loop manner. Instead, the environment has to be
    constantly perceived and the state of the robot must be
    estimated at the same speed. It is obviously difficult
    to achieve required update frequency with computer
    vision, but even state estimates related to the robot
    itself fail to be accurate at high speeds. For example,
    the joint velocities of the \panda{} used primarily
    in this thesis are not accurate at high speeds. That
    proves to be highly problematic when using reactive
    \ac{tg} methods. In this thesis, the problem was usually
    addressed by low-pass filtering the joint velocities
    which on the flip side introduces a delay of the signal.
    Either the estimates must be improved without
    introducing delays or \ac{tg} methods must be robust
    against noise estimates.
  \item The ability to compute trajectories fast is
    discussed in \cref{sec:discussion_fabrics_or_mpc} and we
    believe that \ac{fabrics} offer a good approach to
    address this part of the problem of slow motion.
  \item What is often under-appreciated by the public is
    that speeding up motions has a direct effect on the
    interactions with the environment. For example, when
    grasping objects with a vacuum gripper, as done in 
    \cref{cha:rss_24}, the motion must be slow when
    approaching an item to avoid it tipping over. This
    logical connection is often considered trivial by the
    public but is very difficult to encode in a robot's
    behavior.
  \item And finally, speed of motion and safety are in direct
    conflict. We put fast robots in cages because their
    kinetic energy is dangerous to humans. Having the same
    kind of robots in human-shared environments naturally 
    results in slow motions to compensate for the lack of
    the cage as a safety measure. Unless, we start relying
    on soft-robots to imitate human hardware, this conflict
    seems hard to impossible to resolve.
\end{enumerate}


\textit{Why is does the robot fail at this simple task?} This is not directly a
question of the \ac{tg} problem at hand, but it is often intertangled with it.
It touches upon task and motion planning, a widely studied field of robotics
these days, see \cite{garrett2021integrated} for a recent survey. Especially,
when 


While our modern societies are desperate for automation in human-shared
environments, it is often disappointing to observe the current state of the art
in robotics. From an intellectual point of view however, this is truly exciting,
as the opportunities to shape robotics seem endless. And, from an philosophical
point of view you may ask: \textit{Isn't it quite reassuring that human
abilities are still superior to those of robots when it comes to dynamic
environments?}.
