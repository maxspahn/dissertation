\ProvidesPackage{robots}

\usepackage{tikz}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{arrows.meta,arrows}
\usepackage{pgfplots}
\usepackage{subcaption}

\tikzset{
	treenode/.style = {
		shape=rectangle,
		rounded corners,
		minimum width = 7cm,
		minimum height = 1cm,
		draw, align=center,
		top color=white,
		bottom color=orange
	},
	root/.style     = {treenode, bottom color=red, font=\Large},
	env/.style      = {treenode},
	unimportant/.style    = {treenode, bottom color=white, top color=white, black},
	method/.style 	= {treenode, bottom color=blue, top color = gray, white}
}
%%% DRAW ROBOTS
\usetikzlibrary{patterns}
\usetikzlibrary{math}


% Note. This illustration was originally made with PSTricks. Conversion to
% PGF/TikZ was straightforward. However, I could probably have made it more
% elegant.

% Define a variable as a length
% Input:
%   #1 Variable name
%   #2 Value
%
% Example:
%   \nvar{\varx}{2cm}
\newcommand{\nvar}[2]{%
    \newlength{#1}
    \setlength{#1}{#2}
}

% Define a few constants for drawing
\nvar{\dg}{0.3cm}
\nvar{\basew}{0.25cm}
\nvar{\baseh}{0.5cm}
\nvar{\mbaseh}{1.5cm}
\nvar{\mbasew}{1.0cm}
\nvar{\ddx}{1.0cm}

% Define commands for links, joints and such
\def\link{\draw [double distance=1.5mm, very thick] (0,0)--}
\def\joint{%
    \filldraw [fill=white] (0,0) circle (5pt);
    \fill[black] circle (2pt);
}
\def\grip{%
    \draw[ultra thick](0cm,\dg)--(0cm,-\dg);
    \fill (0cm, 0.5\dg)+(0cm,1.5pt) -- +(0.6\dg,0cm) -- +(0pt,-1.5pt);
    \fill (0cm, -0.5\dg)+(0cm,1.5pt) -- +(0.6\dg,0cm) -- +(0pt,-1.5pt);
    %\filldraw [fill=red] (0,0) circle (5pt);
}
\def\robotbase{%
    \draw[rounded corners=8pt] (-\basew,-\baseh)-- (-\basew, 0) --
        (0,\baseh)--(\basew,0)--(\basew,-\baseh);
    \draw (-0.5,-\baseh)-- (0.5,-\baseh);
    \fill[pattern=north east lines] (-0.5,-1) rectangle (0.5,-\baseh);
}

\def\mobilebase{%
    \draw[rounded corners=8pt] (-\basew,-\baseh)-- (-\basew, 0) --
        (0,\baseh)--(\basew,0)--(\basew,-\baseh);
    \draw (-\mbasew,-\baseh)-- (\mbasew,-\baseh) --(\mbasew, -\mbaseh) -- (-\mbasew,
-\mbaseh) -- (-\mbasew, -\baseh);
    \fill[fill=black!20] (-\mbasew,-0.5) rectangle (\mbasew,-\mbaseh);
    \filldraw [fill=black] (-0.7,-\mbaseh) circle (0.2);
    \filldraw [fill=black] (0.7,-\mbaseh) circle (0.2);
}

\def\dualbase{%
    \draw (-\mbasew,-\baseh)-- (\mbasew,-\baseh) --(\mbasew, -\mbaseh) -- (-\mbasew,
-\mbaseh) -- (-\mbasew, -\baseh);
    \fill[fill=black!20] (-\mbasew,-0.5) rectangle (\mbasew,-\mbaseh);
    \filldraw [fill=black] (-0.7,-\mbaseh) circle (0.2);
    \filldraw [fill=black] (0.7,-\mbaseh) circle (0.2);
    \begin{scope}[shift=(0.0:0.7), rotate=0.0]
    \draw[rounded corners=8pt] (-\basew,-\baseh)-- (-\basew, 0) --
        (0,\baseh)--(\basew,0)--(\basew,-\baseh);
    \end{scope}
    \begin{scope}[shift=(0.0:-0.7), rotate=0.0]
    \draw[rounded corners=8pt] (-\basew,-\baseh)-- (-\basew, 0) --
        (0,\baseh)--(\basew,0)--(\basew,-\baseh);
    \end{scope}
}

% Draw an angle annotation
% Input:
%   #1 Angle
%   #2 Label
% Example:
%   \angann{30}{$\theta_1$}
\newcommand{\angann}[2]{%
    \begin{scope}[red]
    \draw [dashed, red] (0,0) -- (1.2\ddx,0pt);
    \draw [->, shorten >=3.5pt] (\ddx,0pt) arc (0:#1:\ddx);
    % Unfortunately automatic node placement on an arc is not supported yet.
    % We therefore have to compute an appropriate coordinate ourselves.
    \node at (#1/2-2:\ddx+8pt) {#2$^{\circ}$};
    \end{scope}
}

% Draw line annotation
% Input:
%   #1 Line offset (optional)
%   #2 Line angle
%   #3 Line length
%   #5 Line label
% Example:
%   \lineann[1]{30}{2}{$L_1$}
\newcommand{\lineann}[4][0.5]{%
    \begin{scope}[rotate=#2, blue,inner sep=2pt]
        \draw[dashed, blue!40] (0,0) -- +(0,#1)
            node [coordinate, near end] (a) {};
        \draw[dashed, blue!40] (#3,0) -- +(0,#1)
            node [coordinate, near end] (b) {};
        \draw[|<->|] (a) -- node[fill=white] {#4} (b);
    \end{scope}
}

% Plot for tikzpicture generated by matlab2tikz()

% Plot robotbase

\newcommand{\basesimple}{
	\addplot [color=black, line width=3.0pt]
	table[row sep=crcr]{%
		0	0\\
		0.2	0.2\\
		-0.2	0.2\\
		0	0\\
	};
	\addplot [mark size=5.0pt, mark=*, mark options={solid, fill=white, black}, forget plot]
	table[row sep=crcr]{%
		0	0\\
	};
}

% Plot joint and body

\newcommand{\jointbody}[5]{
	\addplot[area legend, line width=2.0pt, draw=black, fill=black, forget plot]
	table[row sep=crcr] {%
		x	y\\
		#1	#2\\
		#3	#4\\
	}--cycle;
	\addplot [mark size=5.0pt, mark=*, mark options={solid, fill=#5}, forget plot]
	table[row sep=crcr]{%
		#3	#4\\
	};
}



% Define the kinematic parameters of the three link manipulator.
\def\thetaone{30}
\def\Lone{2}
\def\thetatwo{125}
\def\Ltwo{2}
\def\thetathree{-30}
\def\Lthree{1}
\def\thetaIKone{26}
\def\thetaIKtwo{-55}
\def\Lunique{2}
